{"ast":null,"code":"\"use strict\";\n\nvar _createForOfIteratorHelper = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/createForOfIteratorHelper.js\").default;\nvar _toConsumableArray = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/toConsumableArray.js\").default;\nvar _regeneratorRuntime = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\").default;\nvar _asyncToGenerator = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\nvar _classCallCheck = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/classCallCheck.js\").default;\nvar _createClass = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/createClass.js\").default;\nvar _get = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/get.js\").default;\nvar _getPrototypeOf = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/getPrototypeOf.js\").default;\nvar _inherits = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/inherits.js\").default;\nvar _createSuper = require(\"C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/@babel/runtime/helpers/createSuper.js\").default;\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n    desc = {\n      enumerable: true,\n      get: function get() {\n        return m[k];\n      }\n    };\n  }\n  Object.defineProperty(o, k2, desc);\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n  __setModuleDefault(result, mod);\n  return result;\n};\nvar __asyncValues = this && this.__asyncValues || function (o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator],\n    i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () {\n    return this;\n  }, i);\n  function verb(n) {\n    i[n] = o[n] && function (v) {\n      return new Promise(function (resolve, reject) {\n        v = o[n](v), settle(resolve, reject, v.done, v.value);\n      });\n    };\n  }\n  function settle(resolve, reject, d, v) {\n    Promise.resolve(v).then(function (v) {\n      resolve({\n        value: v,\n        done: d\n      });\n    }, reject);\n  }\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.downloadProfilePhoto = exports._downloadPhoto = exports._downloadCachedPhotoSize = exports._downloadWebDocument = exports._downloadContact = exports._downloadDocument = exports.downloadMedia = exports.downloadFileV2 = exports.iterDownload = exports.GenericDownloadIter = exports.DirectDownloadIter = void 0;\nvar buffer_1 = require(\"buffer/\");\nvar tl_1 = require(\"../tl\");\nvar Utils_1 = require(\"../Utils\");\nvar Helpers_1 = require(\"../Helpers\");\nvar __1 = require(\"../\");\nvar requestIter_1 = require(\"../requestIter\");\nvar errors_1 = require(\"../errors\");\nvar fs_1 = require(\"./fs\");\nvar extensions_1 = require(\"../extensions\");\nvar fs = __importStar(require(\"./fs\"));\nvar path_1 = __importDefault(require(\"./path\"));\nvar big_integer_1 = __importDefault(require(\"big-integer\"));\n// All types\nvar sizeTypes = [\"w\", \"y\", \"d\", \"x\", \"c\", \"m\", \"b\", \"a\", \"s\"];\n// Chunk sizes for `upload.getFile` must be multiple of the smallest size\nvar MIN_CHUNK_SIZE = 4096;\nvar DEFAULT_CHUNK_SIZE = 64; // kb\nvar ONE_MB = 1024 * 1024;\nvar REQUEST_TIMEOUT = 15000;\nvar DISCONNECT_SLEEP = 1000;\nvar TIMED_OUT_SLEEP = 1000;\nvar MAX_CHUNK_SIZE = 512 * 1024;\nvar DirectDownloadIter = /*#__PURE__*/function (_requestIter_1$Reques, _Symbol$asyncIterator) {\n  _inherits(DirectDownloadIter, _requestIter_1$Reques);\n  var _super = _createSuper(DirectDownloadIter);\n  function DirectDownloadIter() {\n    var _this;\n    _classCallCheck(this, DirectDownloadIter);\n    _this = _super.apply(this, arguments);\n    _this._timedOut = false;\n    return _this;\n  }\n  _createClass(DirectDownloadIter, [{\n    key: \"_init\",\n    value: function () {\n      var _init2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee(_ref) {\n        var fileLocation, dcId, offset, stride, chunkSize, requestSize, fileSize, msgData;\n        return _regeneratorRuntime().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              fileLocation = _ref.fileLocation, dcId = _ref.dcId, offset = _ref.offset, stride = _ref.stride, chunkSize = _ref.chunkSize, requestSize = _ref.requestSize, fileSize = _ref.fileSize, msgData = _ref.msgData;\n              this.request = new tl_1.Api.upload.GetFile({\n                location: fileLocation,\n                offset: offset,\n                limit: requestSize\n              });\n              this.total = fileSize;\n              this._stride = stride;\n              this._chunkSize = chunkSize;\n              this._lastPart = undefined;\n              //this._msgData = msgData;\n              this._timedOut = false;\n              _context.next = 9;\n              return this.client.getSender(dcId);\n            case 9:\n              this._sender = _context.sent;\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee, this);\n      }));\n      function _init(_x) {\n        return _init2.apply(this, arguments);\n      }\n      return _init;\n    }()\n  }, {\n    key: \"_loadNextChunk\",\n    value: function () {\n      var _loadNextChunk2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee2() {\n        var current;\n        return _regeneratorRuntime().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return this._request();\n            case 2:\n              current = _context2.sent;\n              this.buffer.push(current);\n              if (!(current.length < this.request.limit)) {\n                _context2.next = 11;\n                break;\n              }\n              // we finished downloading\n              this.left = this.buffer.length;\n              _context2.next = 8;\n              return this.close();\n            case 8:\n              return _context2.abrupt(\"return\", true);\n            case 11:\n              this.request.offset = this.request.offset.add(this._stride);\n            case 12:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2, this);\n      }));\n      function _loadNextChunk() {\n        return _loadNextChunk2.apply(this, arguments);\n      }\n      return _loadNextChunk;\n    }()\n  }, {\n    key: \"_request\",\n    value: function () {\n      var _request2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee3() {\n        var result;\n        return _regeneratorRuntime().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.prev = 0;\n              _context3.next = 3;\n              return this.client.getSender(this._sender.dcId);\n            case 3:\n              this._sender = _context3.sent;\n              _context3.next = 6;\n              return this.client.invoke(this.request, this._sender);\n            case 6:\n              result = _context3.sent;\n              this._timedOut = false;\n              if (!(result instanceof tl_1.Api.upload.FileCdnRedirect)) {\n                _context3.next = 10;\n                break;\n              }\n              throw new Error(\"CDN Not supported. Please Add an issue in github\");\n            case 10:\n              return _context3.abrupt(\"return\", result.bytes);\n            case 13:\n              _context3.prev = 13;\n              _context3.t0 = _context3[\"catch\"](0);\n              if (!(_context3.t0.errorMessage == \"TIMEOUT\")) {\n                _context3.next = 28;\n                break;\n              }\n              if (!this._timedOut) {\n                _context3.next = 19;\n                break;\n              }\n              this.client._log.warn(\"Got two timeouts in a row while downloading file\");\n              throw _context3.t0;\n            case 19:\n              this._timedOut = true;\n              this.client._log.info(\"Got timeout while downloading file, retrying once\");\n              _context3.next = 23;\n              return (0, Helpers_1.sleep)(TIMED_OUT_SLEEP);\n            case 23:\n              _context3.next = 25;\n              return this._request();\n            case 25:\n              return _context3.abrupt(\"return\", _context3.sent);\n            case 28:\n              if (!(_context3.t0 instanceof errors_1.FileMigrateError)) {\n                _context3.next = 38;\n                break;\n              }\n              this.client._log.info(\"File lives in another DC\");\n              _context3.next = 32;\n              return this.client.getSender(_context3.t0.newDc);\n            case 32:\n              this._sender = _context3.sent;\n              _context3.next = 35;\n              return this._request();\n            case 35:\n              return _context3.abrupt(\"return\", _context3.sent);\n            case 38:\n              if (!(_context3.t0.errorMessage == \"FILEREF_UPGRADE_NEEDED\")) {\n                _context3.next = 42;\n                break;\n              }\n              throw _context3.t0;\n            case 42:\n              throw _context3.t0;\n            case 43:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3, this, [[0, 13]]);\n      }));\n      function _request() {\n        return _request2.apply(this, arguments);\n      }\n      return _request;\n    }()\n  }, {\n    key: \"close\",\n    value: function () {\n      var _close = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee4() {\n        return _regeneratorRuntime().wrap(function _callee4$(_context4) {\n          while (1) switch (_context4.prev = _context4.next) {\n            case 0:\n              this.client._log.debug(\"Finished downloading file ...\");\n            case 1:\n            case \"end\":\n              return _context4.stop();\n          }\n        }, _callee4, this);\n      }));\n      function close() {\n        return _close.apply(this, arguments);\n      }\n      return close;\n    }()\n  }, {\n    key: _Symbol$asyncIterator,\n    value: function value() {\n      return _get(_getPrototypeOf(DirectDownloadIter.prototype), Symbol.asyncIterator, this).call(this);\n    }\n  }]);\n  return DirectDownloadIter;\n}(requestIter_1.RequestIter, Symbol.asyncIterator);\nexports.DirectDownloadIter = DirectDownloadIter;\nvar GenericDownloadIter = /*#__PURE__*/function (_DirectDownloadIter) {\n  _inherits(GenericDownloadIter, _DirectDownloadIter);\n  var _super2 = _createSuper(GenericDownloadIter);\n  function GenericDownloadIter() {\n    _classCallCheck(this, GenericDownloadIter);\n    return _super2.apply(this, arguments);\n  }\n  _createClass(GenericDownloadIter, [{\n    key: \"_loadNextChunk\",\n    value: function () {\n      var _loadNextChunk3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee5() {\n        var data, bad, before, done, current, i;\n        return _regeneratorRuntime().wrap(function _callee5$(_context5) {\n          while (1) switch (_context5.prev = _context5.next) {\n            case 0:\n              // 1. Fetch enough for one chunk\n              data = buffer_1.Buffer.alloc(0); //  1.1. ``bad`` is how much into the data we have we need to offset\n              bad = this.request.offset.divide(this.request.limit).toJSNumber();\n              before = this.request.offset; // 1.2. We have to fetch from a valid offset, so remove that bad part\n              this.request.offset = this.request.offset.subtract(bad);\n              done = false;\n            case 5:\n              if (!(!done && data.length - bad < this._chunkSize)) {\n                _context5.next = 14;\n                break;\n              }\n              _context5.next = 8;\n              return this._request();\n            case 8:\n              current = _context5.sent;\n              this.request.offset = this.request.offset.add(this.request.limit);\n              data = buffer_1.Buffer.concat([data, current]);\n              done = current.length < this.request.limit;\n              _context5.next = 5;\n              break;\n            case 14:\n              // 1.3 Restore our last desired offset\n              this.request.offset = before;\n              // 2. Fill the buffer with the data we have\n              // 2.1. The current chunk starts at ``bad`` offset into the data,\n              //  and each new chunk is ``stride`` bytes apart of the other\n              for (i = bad; i < data.length; i += this._stride) {\n                this.buffer.push(data.slice(i, i + this._chunkSize));\n                // 2.2. We will yield this offset, so move to the next one\n                this.request.offset = this.request.offset.add(this._stride);\n              }\n              // 2.3. If we are in the last chunk, we will return the last partial data\n              if (!done) {\n                _context5.next = 21;\n                break;\n              }\n              this.left = this.buffer.length;\n              _context5.next = 20;\n              return this.close();\n            case 20:\n              return _context5.abrupt(\"return\");\n            case 21:\n              // 2.4 If we are not done, we can't return incomplete chunks.\n              if (this.buffer[this.buffer.length - 1].length != this._chunkSize) {\n                this._lastPart = this.buffer.pop();\n                //   3. Be careful with the offsets. Re-fetching a bit of data\n                //   is fine, since it greatly simplifies things.\n                // TODO Try to not re-fetch data\n                this.request.offset = this.request.offset.subtract(this._stride);\n              }\n            case 22:\n            case \"end\":\n              return _context5.stop();\n          }\n        }, _callee5, this);\n      }));\n      function _loadNextChunk() {\n        return _loadNextChunk3.apply(this, arguments);\n      }\n      return _loadNextChunk;\n    }()\n  }]);\n  return GenericDownloadIter;\n}(DirectDownloadIter);\nexports.GenericDownloadIter = GenericDownloadIter;\n/** @hidden */\nfunction iterDownload(client, _ref2) {\n  var file = _ref2.file,\n    _ref2$offset = _ref2.offset,\n    offset = _ref2$offset === void 0 ? big_integer_1.default.zero : _ref2$offset,\n    stride = _ref2.stride,\n    limit = _ref2.limit,\n    chunkSize = _ref2.chunkSize,\n    _ref2$requestSize = _ref2.requestSize,\n    requestSize = _ref2$requestSize === void 0 ? MAX_CHUNK_SIZE : _ref2$requestSize,\n    fileSize = _ref2.fileSize,\n    dcId = _ref2.dcId,\n    msgData = _ref2.msgData;\n  // we're ignoring here to make it more flexible (which is probably a bad idea)\n  // @ts-ignore\n  var info = __1.utils.getFileInfo(file);\n  if (info.dcId != undefined) {\n    dcId = info.dcId;\n  }\n  if (fileSize == undefined) {\n    fileSize = info.size;\n  }\n  file = info.location;\n  if (chunkSize == undefined) {\n    chunkSize = requestSize;\n  }\n  if (limit == undefined && fileSize != undefined) {\n    limit = Math.floor(fileSize.add(chunkSize).subtract(1).divide(chunkSize).toJSNumber());\n  }\n  if (stride == undefined) {\n    stride = chunkSize;\n  } else if (stride < chunkSize) {\n    throw new Error(\"Stride must be >= chunkSize\");\n  }\n  requestSize -= requestSize % MIN_CHUNK_SIZE;\n  if (requestSize < MIN_CHUNK_SIZE) {\n    requestSize = MIN_CHUNK_SIZE;\n  } else if (requestSize > MAX_CHUNK_SIZE) {\n    requestSize = MAX_CHUNK_SIZE;\n  }\n  var cls;\n  if (chunkSize == requestSize && offset.divide(MAX_CHUNK_SIZE).eq(big_integer_1.default.zero) && stride % MIN_CHUNK_SIZE == 0 && (limit == undefined || offset.divide(limit).eq(big_integer_1.default.zero))) {\n    cls = DirectDownloadIter;\n    client._log.info(\"Starting direct file download in chunks of \".concat(requestSize, \" at \").concat(offset, \", stride \").concat(stride));\n  } else {\n    cls = GenericDownloadIter;\n    client._log.info(\"Starting indirect file download in chunks of \".concat(requestSize, \" at \").concat(offset, \", stride \").concat(stride));\n  }\n  return new cls(client, limit, {}, {\n    fileLocation: file,\n    dcId: dcId,\n    offset: offset,\n    stride: stride,\n    chunkSize: chunkSize,\n    requestSize: requestSize,\n    fileSize: fileSize,\n    msgData: msgData\n  });\n}\nexports.iterDownload = iterDownload;\nfunction getWriter(outputFile) {\n  if (!outputFile || buffer_1.Buffer.isBuffer(outputFile)) {\n    return new extensions_1.BinaryWriter(buffer_1.Buffer.alloc(0));\n  } else if (typeof outputFile == \"string\") {\n    // We want to make sure that the path exists.\n    return (0, fs_1.createWriteStream)(outputFile);\n  } else {\n    return outputFile;\n  }\n}\nfunction closeWriter(writer) {\n  if (\"close\" in writer && writer.close) {\n    writer.close();\n  }\n}\nfunction returnWriterValue(writer) {\n  if (writer instanceof extensions_1.BinaryWriter) {\n    return writer.getValue();\n  }\n  if (writer instanceof fs.WriteStream) {\n    if (typeof writer.path == \"string\") {\n      return path_1.default.resolve(writer.path);\n    } else {\n      return buffer_1.Buffer.from(writer.path);\n    }\n  }\n}\n/** @hidden */\nfunction downloadFileV2(_x2, _x3, _x4) {\n  return _downloadFileV.apply(this, arguments);\n}\nfunction _downloadFileV() {\n  _downloadFileV = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee6(client, inputLocation, _ref3) {\n    var _ref3$outputFile, outputFile, _ref3$partSizeKb, partSizeKb, _ref3$fileSize, fileSize, _ref3$progressCallbac, progressCallback, _ref3$dcId, dcId, _ref3$msgData, msgData, e_1, _a, partSize, writer, downloaded, _b, _c, chunk;\n    return _regeneratorRuntime().wrap(function _callee6$(_context6) {\n      while (1) switch (_context6.prev = _context6.next) {\n        case 0:\n          _ref3$outputFile = _ref3.outputFile, outputFile = _ref3$outputFile === void 0 ? undefined : _ref3$outputFile, _ref3$partSizeKb = _ref3.partSizeKb, partSizeKb = _ref3$partSizeKb === void 0 ? undefined : _ref3$partSizeKb, _ref3$fileSize = _ref3.fileSize, fileSize = _ref3$fileSize === void 0 ? undefined : _ref3$fileSize, _ref3$progressCallbac = _ref3.progressCallback, progressCallback = _ref3$progressCallbac === void 0 ? undefined : _ref3$progressCallbac, _ref3$dcId = _ref3.dcId, dcId = _ref3$dcId === void 0 ? undefined : _ref3$dcId, _ref3$msgData = _ref3.msgData, msgData = _ref3$msgData === void 0 ? undefined : _ref3$msgData;\n          if (!partSizeKb) {\n            if (!fileSize) {\n              partSizeKb = 64;\n            } else {\n              partSizeKb = __1.utils.getAppropriatedPartSize(fileSize);\n            }\n          }\n          partSize = Math.floor(partSizeKb * 1024);\n          if (!(partSize % MIN_CHUNK_SIZE != 0)) {\n            _context6.next = 5;\n            break;\n          }\n          throw new Error(\"The part size must be evenly divisible by 4096\");\n        case 5:\n          writer = getWriter(outputFile);\n          downloaded = big_integer_1.default.zero;\n          _context6.prev = 7;\n          _context6.prev = 8;\n          _b = __asyncValues(iterDownload(client, {\n            file: inputLocation,\n            requestSize: partSize,\n            dcId: dcId,\n            msgData: msgData\n          }));\n        case 10:\n          _context6.next = 12;\n          return _b.next();\n        case 12:\n          _c = _context6.sent;\n          if (_c.done) {\n            _context6.next = 23;\n            break;\n          }\n          chunk = _c.value;\n          _context6.next = 17;\n          return writer.write(chunk);\n        case 17:\n          if (!progressCallback) {\n            _context6.next = 20;\n            break;\n          }\n          _context6.next = 20;\n          return progressCallback(downloaded, (0, big_integer_1.default)(fileSize || big_integer_1.default.zero));\n        case 20:\n          downloaded = downloaded.add(chunk.length);\n        case 21:\n          _context6.next = 10;\n          break;\n        case 23:\n          _context6.next = 28;\n          break;\n        case 25:\n          _context6.prev = 25;\n          _context6.t0 = _context6[\"catch\"](8);\n          e_1 = {\n            error: _context6.t0\n          };\n        case 28:\n          _context6.prev = 28;\n          _context6.prev = 29;\n          if (!(_c && !_c.done && (_a = _b.return))) {\n            _context6.next = 33;\n            break;\n          }\n          _context6.next = 33;\n          return _a.call(_b);\n        case 33:\n          _context6.prev = 33;\n          if (!e_1) {\n            _context6.next = 36;\n            break;\n          }\n          throw e_1.error;\n        case 36:\n          return _context6.finish(33);\n        case 37:\n          return _context6.finish(28);\n        case 38:\n          return _context6.abrupt(\"return\", returnWriterValue(writer));\n        case 39:\n          _context6.prev = 39;\n          closeWriter(writer);\n          return _context6.finish(39);\n        case 42:\n        case \"end\":\n          return _context6.stop();\n      }\n    }, _callee6, null, [[7,, 39, 42], [8, 25, 28, 38], [29,, 33, 37]]);\n  }));\n  return _downloadFileV.apply(this, arguments);\n}\nexports.downloadFileV2 = downloadFileV2;\nvar Foreman = /*#__PURE__*/function () {\n  function Foreman(maxWorkers) {\n    _classCallCheck(this, Foreman);\n    this.maxWorkers = maxWorkers;\n    this.activeWorkers = 0;\n  }\n  _createClass(Foreman, [{\n    key: \"requestWorker\",\n    value: function requestWorker() {\n      this.activeWorkers++;\n      if (this.activeWorkers > this.maxWorkers) {\n        this.deferred = createDeferred();\n        return this.deferred.promise;\n      }\n      return Promise.resolve();\n    }\n  }, {\n    key: \"releaseWorker\",\n    value: function releaseWorker() {\n      this.activeWorkers--;\n      if (this.deferred && this.activeWorkers <= this.maxWorkers) {\n        this.deferred.resolve();\n      }\n    }\n  }]);\n  return Foreman;\n}();\nfunction createDeferred() {\n  var resolve;\n  var promise = new Promise(function (_resolve) {\n    resolve = _resolve;\n  });\n  return {\n    promise: promise,\n    resolve: resolve\n  };\n}\n/** @hidden */\nfunction downloadMedia(_x5, _x6, _x7, _x8, _x9) {\n  return _downloadMedia.apply(this, arguments);\n}\nfunction _downloadMedia() {\n  _downloadMedia = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee7(client, messageOrMedia, outputFile, thumb, progressCallback) {\n    var msgData, date, media;\n    return _regeneratorRuntime().wrap(function _callee7$(_context7) {\n      while (1) switch (_context7.prev = _context7.next) {\n        case 0:\n          /*\r\n            Downloading large documents may be slow enough to require a new file reference\r\n            to be obtained mid-download. Store (input chat, message id) so that the message\r\n            can be re-fetched.\r\n           */\n\n          if (messageOrMedia instanceof tl_1.Api.Message) {\n            media = messageOrMedia.media;\n            date = messageOrMedia.date;\n            msgData = messageOrMedia.inputChat ? [messageOrMedia.inputChat, messageOrMedia.id] : undefined;\n          } else {\n            media = messageOrMedia;\n            date = Date.now();\n          }\n          if (!(typeof media == \"string\")) {\n            _context7.next = 3;\n            break;\n          }\n          throw new Error(\"not implemented\");\n        case 3:\n          if (media instanceof tl_1.Api.MessageMediaWebPage) {\n            if (media.webpage instanceof tl_1.Api.WebPage) {\n              media = media.webpage.document || media.webpage.photo;\n            }\n          }\n          if (!(media instanceof tl_1.Api.MessageMediaPhoto || media instanceof tl_1.Api.Photo)) {\n            _context7.next = 8;\n            break;\n          }\n          return _context7.abrupt(\"return\", _downloadPhoto(client, media, outputFile, date, thumb, progressCallback));\n        case 8:\n          if (!(media instanceof tl_1.Api.MessageMediaDocument || media instanceof tl_1.Api.Document)) {\n            _context7.next = 12;\n            break;\n          }\n          return _context7.abrupt(\"return\", _downloadDocument(client, media, outputFile, date, thumb, progressCallback, msgData));\n        case 12:\n          if (!(media instanceof tl_1.Api.MessageMediaContact)) {\n            _context7.next = 16;\n            break;\n          }\n          return _context7.abrupt(\"return\", _downloadContact(client, media, {}));\n        case 16:\n          if (!(media instanceof tl_1.Api.WebDocument || media instanceof tl_1.Api.WebDocumentNoProxy)) {\n            _context7.next = 20;\n            break;\n          }\n          return _context7.abrupt(\"return\", _downloadWebDocument(client, media, {}));\n        case 20:\n          return _context7.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 21:\n        case \"end\":\n          return _context7.stop();\n      }\n    }, _callee7);\n  }));\n  return _downloadMedia.apply(this, arguments);\n}\nexports.downloadMedia = downloadMedia;\n/** @hidden */\nfunction _downloadDocument(_x10, _x11, _x12, _x13, _x14, _x15, _x16) {\n  return _downloadDocument2.apply(this, arguments);\n}\nfunction _downloadDocument2() {\n  _downloadDocument2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee8(client, doc, outputFile, date, thumb, progressCallback, msgData) {\n    var size;\n    return _regeneratorRuntime().wrap(function _callee8$(_context8) {\n      while (1) switch (_context8.prev = _context8.next) {\n        case 0:\n          if (!(doc instanceof tl_1.Api.MessageMediaDocument)) {\n            _context8.next = 4;\n            break;\n          }\n          if (doc.document) {\n            _context8.next = 3;\n            break;\n          }\n          return _context8.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 3:\n          doc = doc.document;\n        case 4:\n          if (doc instanceof tl_1.Api.Document) {\n            _context8.next = 6;\n            break;\n          }\n          return _context8.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 6:\n          if (!(thumb == undefined)) {\n            _context8.next = 10;\n            break;\n          }\n          outputFile = getProperFilename(outputFile, \"document\", \".\" + (__1.utils.getExtension(doc) || \"bin\"), date);\n          _context8.next = 14;\n          break;\n        case 10:\n          outputFile = getProperFilename(outputFile, \"photo\", \".jpg\", date);\n          size = getThumb(doc.thumbs || [], thumb);\n          if (!(size instanceof tl_1.Api.PhotoCachedSize || size instanceof tl_1.Api.PhotoStrippedSize)) {\n            _context8.next = 14;\n            break;\n          }\n          return _context8.abrupt(\"return\", _downloadCachedPhotoSize(size, outputFile));\n        case 14:\n          _context8.next = 16;\n          return downloadFileV2(client, new tl_1.Api.InputDocumentFileLocation({\n            id: doc.id,\n            accessHash: doc.accessHash,\n            fileReference: doc.fileReference,\n            thumbSize: size ? size.type : \"\"\n          }), {\n            outputFile: outputFile,\n            fileSize: size && \"size\" in size ? (0, big_integer_1.default)(size.size) : doc.size,\n            progressCallback: progressCallback,\n            msgData: msgData\n          });\n        case 16:\n          return _context8.abrupt(\"return\", _context8.sent);\n        case 17:\n        case \"end\":\n          return _context8.stop();\n      }\n    }, _callee8);\n  }));\n  return _downloadDocument2.apply(this, arguments);\n}\nexports._downloadDocument = _downloadDocument;\n/** @hidden */\nfunction _downloadContact(_x17, _x18, _x19) {\n  return _downloadContact2.apply(this, arguments);\n}\nfunction _downloadContact2() {\n  _downloadContact2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee9(client, media, args) {\n    return _regeneratorRuntime().wrap(function _callee9$(_context9) {\n      while (1) switch (_context9.prev = _context9.next) {\n        case 0:\n          throw new Error(\"not implemented\");\n        case 1:\n        case \"end\":\n          return _context9.stop();\n      }\n    }, _callee9);\n  }));\n  return _downloadContact2.apply(this, arguments);\n}\nexports._downloadContact = _downloadContact;\n/** @hidden */\nfunction _downloadWebDocument(_x20, _x21, _x22) {\n  return _downloadWebDocument2.apply(this, arguments);\n}\nfunction _downloadWebDocument2() {\n  _downloadWebDocument2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee10(client, media, args) {\n    return _regeneratorRuntime().wrap(function _callee10$(_context10) {\n      while (1) switch (_context10.prev = _context10.next) {\n        case 0:\n          throw new Error(\"not implemented\");\n        case 1:\n        case \"end\":\n          return _context10.stop();\n      }\n    }, _callee10);\n  }));\n  return _downloadWebDocument2.apply(this, arguments);\n}\nexports._downloadWebDocument = _downloadWebDocument;\nfunction pickFileSize(sizes, sizeType) {\n  if (!sizeType || !sizes || !sizes.length) {\n    return undefined;\n  }\n  var indexOfSize = sizeTypes.indexOf(sizeType);\n  var size;\n  var _loop = function _loop(i) {\n    size = sizes.find(function (s) {\n      return s.type === sizeTypes[i];\n    });\n    if (size && !(size instanceof tl_1.Api.PhotoPathSize)) {\n      return {\n        v: size\n      };\n    }\n  };\n  for (var i = indexOfSize; i < sizeTypes.length; i++) {\n    var _ret = _loop(i);\n    if (typeof _ret === \"object\") return _ret.v;\n  }\n  return undefined;\n}\n/** @hidden */\nfunction getThumb(thumbs, thumb) {\n  function sortThumb(thumb) {\n    if (thumb instanceof tl_1.Api.PhotoStrippedSize) {\n      return thumb.bytes.length;\n    }\n    if (thumb instanceof tl_1.Api.PhotoCachedSize) {\n      return thumb.bytes.length;\n    }\n    if (thumb instanceof tl_1.Api.PhotoSize) {\n      return thumb.size;\n    }\n    if (thumb instanceof tl_1.Api.PhotoSizeProgressive) {\n      return Math.max.apply(Math, _toConsumableArray(thumb.sizes));\n    }\n    if (thumb instanceof tl_1.Api.VideoSize) {\n      return thumb.size;\n    }\n    return 0;\n  }\n  thumbs = thumbs.sort(function (a, b) {\n    return sortThumb(a) - sortThumb(b);\n  });\n  var correctThumbs = [];\n  var _iterator = _createForOfIteratorHelper(thumbs),\n    _step;\n  try {\n    for (_iterator.s(); !(_step = _iterator.n()).done;) {\n      var _t = _step.value;\n      if (!(_t instanceof tl_1.Api.PhotoPathSize)) {\n        correctThumbs.push(_t);\n      }\n    }\n  } catch (err) {\n    _iterator.e(err);\n  } finally {\n    _iterator.f();\n  }\n  if (thumb == undefined) {\n    return correctThumbs.pop();\n  } else if (typeof thumb == \"number\") {\n    return correctThumbs[thumb];\n  } else if (typeof thumb == \"string\") {\n    var _iterator2 = _createForOfIteratorHelper(correctThumbs),\n      _step2;\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var t = _step2.value;\n        if (t.type == thumb) {\n          return t;\n        }\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  } else if (thumb instanceof tl_1.Api.PhotoSize || thumb instanceof tl_1.Api.PhotoCachedSize || thumb instanceof tl_1.Api.PhotoStrippedSize || thumb instanceof tl_1.Api.VideoSize) {\n    return thumb;\n  }\n}\n/** @hidden */\nfunction _downloadCachedPhotoSize(_x23, _x24) {\n  return _downloadCachedPhotoSize2.apply(this, arguments);\n}\nfunction _downloadCachedPhotoSize2() {\n  _downloadCachedPhotoSize2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee11(size, outputFile) {\n    var data, writer;\n    return _regeneratorRuntime().wrap(function _callee11$(_context11) {\n      while (1) switch (_context11.prev = _context11.next) {\n        case 0:\n          // No need to download anything, simply write the bytes\n\n          if (size instanceof tl_1.Api.PhotoStrippedSize) {\n            data = (0, Utils_1.strippedPhotoToJpg)(size.bytes);\n          } else {\n            data = size.bytes;\n          }\n          writer = getWriter(outputFile);\n          _context11.prev = 2;\n          _context11.next = 5;\n          return writer.write(data);\n        case 5:\n          _context11.prev = 5;\n          closeWriter(writer);\n          return _context11.finish(5);\n        case 8:\n          return _context11.abrupt(\"return\", returnWriterValue(writer));\n        case 9:\n        case \"end\":\n          return _context11.stop();\n      }\n    }, _callee11, null, [[2,, 5, 8]]);\n  }));\n  return _downloadCachedPhotoSize2.apply(this, arguments);\n}\nexports._downloadCachedPhotoSize = _downloadCachedPhotoSize;\n/** @hidden */\nfunction getProperFilename(file, fileType, extension, date) {\n  if (!file || typeof file != \"string\") {\n    return file;\n  }\n  if (fs.existsSync(file) && fs.lstatSync(file).isDirectory()) {\n    var fullName = fileType + date + extension;\n    return path_1.default.join(file, fullName);\n  }\n  return file;\n}\n/** @hidden */\nfunction _downloadPhoto(_x25, _x26, _x27, _x28, _x29, _x30) {\n  return _downloadPhoto2.apply(this, arguments);\n}\nfunction _downloadPhoto2() {\n  _downloadPhoto2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee12(client, photo, file, date, thumb, progressCallback) {\n    var photoSizes, size, fileSize;\n    return _regeneratorRuntime().wrap(function _callee12$(_context12) {\n      while (1) switch (_context12.prev = _context12.next) {\n        case 0:\n          if (!(photo instanceof tl_1.Api.MessageMediaPhoto)) {\n            _context12.next = 4;\n            break;\n          }\n          if (!(photo.photo instanceof tl_1.Api.PhotoEmpty || !photo.photo)) {\n            _context12.next = 3;\n            break;\n          }\n          return _context12.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 3:\n          photo = photo.photo;\n        case 4:\n          if (photo instanceof tl_1.Api.Photo) {\n            _context12.next = 6;\n            break;\n          }\n          return _context12.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 6:\n          photoSizes = [].concat(_toConsumableArray(photo.sizes || []), _toConsumableArray(photo.videoSizes || []));\n          size = getThumb(photoSizes, thumb);\n          if (!(!size || size instanceof tl_1.Api.PhotoSizeEmpty)) {\n            _context12.next = 10;\n            break;\n          }\n          return _context12.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 10:\n          if (!date) {\n            date = Date.now();\n          }\n          file = getProperFilename(file, \"photo\", \".jpg\", date);\n          if (!(size instanceof tl_1.Api.PhotoCachedSize || size instanceof tl_1.Api.PhotoStrippedSize)) {\n            _context12.next = 14;\n            break;\n          }\n          return _context12.abrupt(\"return\", _downloadCachedPhotoSize(size, file));\n        case 14:\n          if (size instanceof tl_1.Api.PhotoSizeProgressive) {\n            fileSize = Math.max.apply(Math, _toConsumableArray(size.sizes));\n          } else {\n            fileSize = size.size;\n          }\n          return _context12.abrupt(\"return\", downloadFileV2(client, new tl_1.Api.InputPhotoFileLocation({\n            id: photo.id,\n            accessHash: photo.accessHash,\n            fileReference: photo.fileReference,\n            thumbSize: size.type\n          }), {\n            outputFile: file,\n            fileSize: (0, big_integer_1.default)(fileSize),\n            progressCallback: progressCallback,\n            dcId: photo.dcId\n          }));\n        case 16:\n        case \"end\":\n          return _context12.stop();\n      }\n    }, _callee12);\n  }));\n  return _downloadPhoto2.apply(this, arguments);\n}\nexports._downloadPhoto = _downloadPhoto;\n/** @hidden */\nfunction downloadProfilePhoto(_x31, _x32, _x33) {\n  return _downloadProfilePhoto.apply(this, arguments);\n}\nfunction _downloadProfilePhoto() {\n  _downloadProfilePhoto = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime().mark(function _callee13(client, entity, fileParams) {\n    var photo, dcId, loc;\n    return _regeneratorRuntime().wrap(function _callee13$(_context13) {\n      while (1) switch (_context13.prev = _context13.next) {\n        case 0:\n          if (!(typeof entity == \"object\" && \"photo\" in entity)) {\n            _context13.next = 4;\n            break;\n          }\n          photo = entity.photo;\n          _context13.next = 12;\n          break;\n        case 4:\n          _context13.next = 6;\n          return client.getEntity(entity);\n        case 6:\n          entity = _context13.sent;\n          if (!(\"photo\" in entity)) {\n            _context13.next = 11;\n            break;\n          }\n          photo = entity.photo;\n          _context13.next = 12;\n          break;\n        case 11:\n          throw new Error(\"Could not get photo from \".concat(entity ? entity.className : undefined));\n        case 12:\n          if (!(photo instanceof tl_1.Api.UserProfilePhoto || photo instanceof tl_1.Api.ChatPhoto)) {\n            _context13.next = 17;\n            break;\n          }\n          dcId = photo.dcId;\n          loc = new tl_1.Api.InputPeerPhotoFileLocation({\n            peer: __1.utils.getInputPeer(entity),\n            photoId: photo.photoId,\n            big: fileParams.isBig\n          });\n          _context13.next = 18;\n          break;\n        case 17:\n          return _context13.abrupt(\"return\", buffer_1.Buffer.alloc(0));\n        case 18:\n          return _context13.abrupt(\"return\", client.downloadFile(loc, {\n            outputFile: fileParams.outputFile,\n            dcId: dcId\n          }));\n        case 19:\n        case \"end\":\n          return _context13.stop();\n      }\n    }, _callee13);\n  }));\n  return _downloadProfilePhoto.apply(this, arguments);\n}\nexports.downloadProfilePhoto = downloadProfilePhoto;","map":{"version":3,"names":["__createBinding","Object","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","get","defineProperty","__setModuleDefault","v","value","__importStar","mod","result","prototype","hasOwnProperty","call","__asyncValues","Symbol","asyncIterator","TypeError","i","__values","iterator","verb","n","Promise","resolve","reject","settle","done","d","then","__importDefault","exports","downloadProfilePhoto","_downloadPhoto","_downloadCachedPhotoSize","_downloadWebDocument","_downloadContact","_downloadDocument","downloadMedia","downloadFileV2","iterDownload","GenericDownloadIter","DirectDownloadIter","buffer_1","require","tl_1","Utils_1","Helpers_1","__1","requestIter_1","errors_1","fs_1","extensions_1","fs","path_1","big_integer_1","sizeTypes","MIN_CHUNK_SIZE","DEFAULT_CHUNK_SIZE","ONE_MB","REQUEST_TIMEOUT","DISCONNECT_SLEEP","TIMED_OUT_SLEEP","MAX_CHUNK_SIZE","arguments","_timedOut","fileLocation","dcId","offset","stride","chunkSize","requestSize","fileSize","msgData","request","Api","upload","GetFile","location","limit","total","_stride","_chunkSize","_lastPart","client","getSender","_sender","_request","current","buffer","push","length","left","close","add","invoke","FileCdnRedirect","Error","bytes","errorMessage","_log","warn","info","sleep","FileMigrateError","newDc","debug","RequestIter","data","Buffer","alloc","bad","divide","toJSNumber","before","subtract","concat","slice","pop","file","default","zero","utils","getFileInfo","size","Math","floor","cls","eq","getWriter","outputFile","isBuffer","BinaryWriter","createWriteStream","closeWriter","writer","returnWriterValue","getValue","WriteStream","path","from","inputLocation","partSizeKb","progressCallback","getAppropriatedPartSize","partSize","downloaded","_b","next","_c","chunk","write","e_1","error","_a","return","Foreman","maxWorkers","activeWorkers","deferred","createDeferred","promise","_resolve","messageOrMedia","thumb","Message","media","date","inputChat","id","Date","now","MessageMediaWebPage","webpage","WebPage","document","photo","MessageMediaPhoto","Photo","MessageMediaDocument","Document","MessageMediaContact","WebDocument","WebDocumentNoProxy","doc","getProperFilename","getExtension","getThumb","thumbs","PhotoCachedSize","PhotoStrippedSize","InputDocumentFileLocation","accessHash","fileReference","thumbSize","type","args","pickFileSize","sizes","sizeType","indexOfSize","indexOf","find","s","PhotoPathSize","sortThumb","PhotoSize","PhotoSizeProgressive","max","VideoSize","sort","a","b","correctThumbs","t","strippedPhotoToJpg","fileType","extension","existsSync","lstatSync","isDirectory","fullName","join","PhotoEmpty","photoSizes","videoSizes","PhotoSizeEmpty","InputPhotoFileLocation","entity","fileParams","getEntity","className","UserProfilePhoto","ChatPhoto","loc","InputPeerPhotoFileLocation","peer","getInputPeer","photoId","big","isBig","downloadFile"],"sources":["C:/Users/Yakov/Desktop/projects/node-projects/node-js-key-monitor/sladrus.github.io/node_modules/telegram/client/downloads.js"],"sourcesContent":["\"use strict\";\r\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    var desc = Object.getOwnPropertyDescriptor(m, k);\r\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\r\n      desc = { enumerable: true, get: function() { return m[k]; } };\r\n    }\r\n    Object.defineProperty(o, k2, desc);\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}));\r\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n});\r\nvar __importStar = (this && this.__importStar) || function (mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n};\r\nvar __asyncValues = (this && this.__asyncValues) || function (o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nexports.downloadProfilePhoto = exports._downloadPhoto = exports._downloadCachedPhotoSize = exports._downloadWebDocument = exports._downloadContact = exports._downloadDocument = exports.downloadMedia = exports.downloadFileV2 = exports.iterDownload = exports.GenericDownloadIter = exports.DirectDownloadIter = void 0;\r\nconst buffer_1 = require(\"buffer/\");\r\nconst tl_1 = require(\"../tl\");\r\nconst Utils_1 = require(\"../Utils\");\r\nconst Helpers_1 = require(\"../Helpers\");\r\nconst __1 = require(\"../\");\r\nconst requestIter_1 = require(\"../requestIter\");\r\nconst errors_1 = require(\"../errors\");\r\nconst fs_1 = require(\"./fs\");\r\nconst extensions_1 = require(\"../extensions\");\r\nconst fs = __importStar(require(\"./fs\"));\r\nconst path_1 = __importDefault(require(\"./path\"));\r\nconst big_integer_1 = __importDefault(require(\"big-integer\"));\r\n// All types\r\nconst sizeTypes = [\"w\", \"y\", \"d\", \"x\", \"c\", \"m\", \"b\", \"a\", \"s\"];\r\n// Chunk sizes for `upload.getFile` must be multiple of the smallest size\r\nconst MIN_CHUNK_SIZE = 4096;\r\nconst DEFAULT_CHUNK_SIZE = 64; // kb\r\nconst ONE_MB = 1024 * 1024;\r\nconst REQUEST_TIMEOUT = 15000;\r\nconst DISCONNECT_SLEEP = 1000;\r\nconst TIMED_OUT_SLEEP = 1000;\r\nconst MAX_CHUNK_SIZE = 512 * 1024;\r\nclass DirectDownloadIter extends requestIter_1.RequestIter {\r\n    constructor() {\r\n        super(...arguments);\r\n        this._timedOut = false;\r\n    }\r\n    async _init({ fileLocation, dcId, offset, stride, chunkSize, requestSize, fileSize, msgData, }) {\r\n        this.request = new tl_1.Api.upload.GetFile({\r\n            location: fileLocation,\r\n            offset,\r\n            limit: requestSize,\r\n        });\r\n        this.total = fileSize;\r\n        this._stride = stride;\r\n        this._chunkSize = chunkSize;\r\n        this._lastPart = undefined;\r\n        //this._msgData = msgData;\r\n        this._timedOut = false;\r\n        this._sender = await this.client.getSender(dcId);\r\n    }\r\n    async _loadNextChunk() {\r\n        const current = await this._request();\r\n        this.buffer.push(current);\r\n        if (current.length < this.request.limit) {\r\n            // we finished downloading\r\n            this.left = this.buffer.length;\r\n            await this.close();\r\n            return true;\r\n        }\r\n        else {\r\n            this.request.offset = this.request.offset.add(this._stride);\r\n        }\r\n    }\r\n    async _request() {\r\n        try {\r\n            this._sender = await this.client.getSender(this._sender.dcId);\r\n            const result = await this.client.invoke(this.request, this._sender);\r\n            this._timedOut = false;\r\n            if (result instanceof tl_1.Api.upload.FileCdnRedirect) {\r\n                throw new Error(\"CDN Not supported. Please Add an issue in github\");\r\n            }\r\n            return result.bytes;\r\n        }\r\n        catch (e) {\r\n            if (e.errorMessage == \"TIMEOUT\") {\r\n                if (this._timedOut) {\r\n                    this.client._log.warn(\"Got two timeouts in a row while downloading file\");\r\n                    throw e;\r\n                }\r\n                this._timedOut = true;\r\n                this.client._log.info(\"Got timeout while downloading file, retrying once\");\r\n                await (0, Helpers_1.sleep)(TIMED_OUT_SLEEP);\r\n                return await this._request();\r\n            }\r\n            else if (e instanceof errors_1.FileMigrateError) {\r\n                this.client._log.info(\"File lives in another DC\");\r\n                this._sender = await this.client.getSender(e.newDc);\r\n                return await this._request();\r\n            }\r\n            else if (e.errorMessage == \"FILEREF_UPGRADE_NEEDED\") {\r\n                // TODO later\r\n                throw e;\r\n            }\r\n            else {\r\n                throw e;\r\n            }\r\n        }\r\n    }\r\n    async close() {\r\n        this.client._log.debug(\"Finished downloading file ...\");\r\n    }\r\n    [Symbol.asyncIterator]() {\r\n        return super[Symbol.asyncIterator]();\r\n    }\r\n}\r\nexports.DirectDownloadIter = DirectDownloadIter;\r\nclass GenericDownloadIter extends DirectDownloadIter {\r\n    async _loadNextChunk() {\r\n        // 1. Fetch enough for one chunk\r\n        let data = buffer_1.Buffer.alloc(0);\r\n        //  1.1. ``bad`` is how much into the data we have we need to offset\r\n        const bad = this.request.offset.divide(this.request.limit).toJSNumber();\r\n        const before = this.request.offset;\r\n        // 1.2. We have to fetch from a valid offset, so remove that bad part\r\n        this.request.offset = this.request.offset.subtract(bad);\r\n        let done = false;\r\n        while (!done && data.length - bad < this._chunkSize) {\r\n            const current = await this._request();\r\n            this.request.offset = this.request.offset.add(this.request.limit);\r\n            data = buffer_1.Buffer.concat([data, current]);\r\n            done = current.length < this.request.limit;\r\n        }\r\n        // 1.3 Restore our last desired offset\r\n        this.request.offset = before;\r\n        // 2. Fill the buffer with the data we have\r\n        // 2.1. The current chunk starts at ``bad`` offset into the data,\r\n        //  and each new chunk is ``stride`` bytes apart of the other\r\n        for (let i = bad; i < data.length; i += this._stride) {\r\n            this.buffer.push(data.slice(i, i + this._chunkSize));\r\n            // 2.2. We will yield this offset, so move to the next one\r\n            this.request.offset = this.request.offset.add(this._stride);\r\n        }\r\n        // 2.3. If we are in the last chunk, we will return the last partial data\r\n        if (done) {\r\n            this.left = this.buffer.length;\r\n            await this.close();\r\n            return;\r\n        }\r\n        // 2.4 If we are not done, we can't return incomplete chunks.\r\n        if (this.buffer[this.buffer.length - 1].length != this._chunkSize) {\r\n            this._lastPart = this.buffer.pop();\r\n            //   3. Be careful with the offsets. Re-fetching a bit of data\r\n            //   is fine, since it greatly simplifies things.\r\n            // TODO Try to not re-fetch data\r\n            this.request.offset = this.request.offset.subtract(this._stride);\r\n        }\r\n    }\r\n}\r\nexports.GenericDownloadIter = GenericDownloadIter;\r\n/** @hidden */\r\nfunction iterDownload(client, { file, offset = big_integer_1.default.zero, stride, limit, chunkSize, requestSize = MAX_CHUNK_SIZE, fileSize, dcId, msgData, }) {\r\n    // we're ignoring here to make it more flexible (which is probably a bad idea)\r\n    // @ts-ignore\r\n    const info = __1.utils.getFileInfo(file);\r\n    if (info.dcId != undefined) {\r\n        dcId = info.dcId;\r\n    }\r\n    if (fileSize == undefined) {\r\n        fileSize = info.size;\r\n    }\r\n    file = info.location;\r\n    if (chunkSize == undefined) {\r\n        chunkSize = requestSize;\r\n    }\r\n    if (limit == undefined && fileSize != undefined) {\r\n        limit = Math.floor(fileSize.add(chunkSize).subtract(1).divide(chunkSize).toJSNumber());\r\n    }\r\n    if (stride == undefined) {\r\n        stride = chunkSize;\r\n    }\r\n    else if (stride < chunkSize) {\r\n        throw new Error(\"Stride must be >= chunkSize\");\r\n    }\r\n    requestSize -= requestSize % MIN_CHUNK_SIZE;\r\n    if (requestSize < MIN_CHUNK_SIZE) {\r\n        requestSize = MIN_CHUNK_SIZE;\r\n    }\r\n    else if (requestSize > MAX_CHUNK_SIZE) {\r\n        requestSize = MAX_CHUNK_SIZE;\r\n    }\r\n    let cls;\r\n    if (chunkSize == requestSize &&\r\n        offset.divide(MAX_CHUNK_SIZE).eq(big_integer_1.default.zero) &&\r\n        stride % MIN_CHUNK_SIZE == 0 &&\r\n        (limit == undefined || offset.divide(limit).eq(big_integer_1.default.zero))) {\r\n        cls = DirectDownloadIter;\r\n        client._log.info(`Starting direct file download in chunks of ${requestSize} at ${offset}, stride ${stride}`);\r\n    }\r\n    else {\r\n        cls = GenericDownloadIter;\r\n        client._log.info(`Starting indirect file download in chunks of ${requestSize} at ${offset}, stride ${stride}`);\r\n    }\r\n    return new cls(client, limit, {}, {\r\n        fileLocation: file,\r\n        dcId,\r\n        offset,\r\n        stride,\r\n        chunkSize,\r\n        requestSize,\r\n        fileSize,\r\n        msgData,\r\n    });\r\n}\r\nexports.iterDownload = iterDownload;\r\nfunction getWriter(outputFile) {\r\n    if (!outputFile || buffer_1.Buffer.isBuffer(outputFile)) {\r\n        return new extensions_1.BinaryWriter(buffer_1.Buffer.alloc(0));\r\n    }\r\n    else if (typeof outputFile == \"string\") {\r\n        // We want to make sure that the path exists.\r\n        return (0, fs_1.createWriteStream)(outputFile);\r\n    }\r\n    else {\r\n        return outputFile;\r\n    }\r\n}\r\nfunction closeWriter(writer) {\r\n    if (\"close\" in writer && writer.close) {\r\n        writer.close();\r\n    }\r\n}\r\nfunction returnWriterValue(writer) {\r\n    if (writer instanceof extensions_1.BinaryWriter) {\r\n        return writer.getValue();\r\n    }\r\n    if (writer instanceof fs.WriteStream) {\r\n        if (typeof writer.path == \"string\") {\r\n            return path_1.default.resolve(writer.path);\r\n        }\r\n        else {\r\n            return buffer_1.Buffer.from(writer.path);\r\n        }\r\n    }\r\n}\r\n/** @hidden */\r\nasync function downloadFileV2(client, inputLocation, { outputFile = undefined, partSizeKb = undefined, fileSize = undefined, progressCallback = undefined, dcId = undefined, msgData = undefined, }) {\r\n    var e_1, _a;\r\n    if (!partSizeKb) {\r\n        if (!fileSize) {\r\n            partSizeKb = 64;\r\n        }\r\n        else {\r\n            partSizeKb = __1.utils.getAppropriatedPartSize(fileSize);\r\n        }\r\n    }\r\n    const partSize = Math.floor(partSizeKb * 1024);\r\n    if (partSize % MIN_CHUNK_SIZE != 0) {\r\n        throw new Error(\"The part size must be evenly divisible by 4096\");\r\n    }\r\n    const writer = getWriter(outputFile);\r\n    let downloaded = big_integer_1.default.zero;\r\n    try {\r\n        try {\r\n            for (var _b = __asyncValues(iterDownload(client, {\r\n                file: inputLocation,\r\n                requestSize: partSize,\r\n                dcId: dcId,\r\n                msgData: msgData,\r\n            })), _c; _c = await _b.next(), !_c.done;) {\r\n                const chunk = _c.value;\r\n                await writer.write(chunk);\r\n                if (progressCallback) {\r\n                    await progressCallback(downloaded, (0, big_integer_1.default)(fileSize || big_integer_1.default.zero));\r\n                }\r\n                downloaded = downloaded.add(chunk.length);\r\n            }\r\n        }\r\n        catch (e_1_1) { e_1 = { error: e_1_1 }; }\r\n        finally {\r\n            try {\r\n                if (_c && !_c.done && (_a = _b.return)) await _a.call(_b);\r\n            }\r\n            finally { if (e_1) throw e_1.error; }\r\n        }\r\n        return returnWriterValue(writer);\r\n    }\r\n    finally {\r\n        closeWriter(writer);\r\n    }\r\n}\r\nexports.downloadFileV2 = downloadFileV2;\r\nclass Foreman {\r\n    constructor(maxWorkers) {\r\n        this.maxWorkers = maxWorkers;\r\n        this.activeWorkers = 0;\r\n    }\r\n    requestWorker() {\r\n        this.activeWorkers++;\r\n        if (this.activeWorkers > this.maxWorkers) {\r\n            this.deferred = createDeferred();\r\n            return this.deferred.promise;\r\n        }\r\n        return Promise.resolve();\r\n    }\r\n    releaseWorker() {\r\n        this.activeWorkers--;\r\n        if (this.deferred && this.activeWorkers <= this.maxWorkers) {\r\n            this.deferred.resolve();\r\n        }\r\n    }\r\n}\r\nfunction createDeferred() {\r\n    let resolve;\r\n    const promise = new Promise((_resolve) => {\r\n        resolve = _resolve;\r\n    });\r\n    return {\r\n        promise,\r\n        resolve: resolve,\r\n    };\r\n}\r\n/** @hidden */\r\nasync function downloadMedia(client, messageOrMedia, outputFile, thumb, progressCallback) {\r\n    /*\r\n      Downloading large documents may be slow enough to require a new file reference\r\n      to be obtained mid-download. Store (input chat, message id) so that the message\r\n      can be re-fetched.\r\n     */\r\n    let msgData;\r\n    let date;\r\n    let media;\r\n    if (messageOrMedia instanceof tl_1.Api.Message) {\r\n        media = messageOrMedia.media;\r\n        date = messageOrMedia.date;\r\n        msgData = messageOrMedia.inputChat\r\n            ? [messageOrMedia.inputChat, messageOrMedia.id]\r\n            : undefined;\r\n    }\r\n    else {\r\n        media = messageOrMedia;\r\n        date = Date.now();\r\n    }\r\n    if (typeof media == \"string\") {\r\n        throw new Error(\"not implemented\");\r\n    }\r\n    if (media instanceof tl_1.Api.MessageMediaWebPage) {\r\n        if (media.webpage instanceof tl_1.Api.WebPage) {\r\n            media = media.webpage.document || media.webpage.photo;\r\n        }\r\n    }\r\n    if (media instanceof tl_1.Api.MessageMediaPhoto || media instanceof tl_1.Api.Photo) {\r\n        return _downloadPhoto(client, media, outputFile, date, thumb, progressCallback);\r\n    }\r\n    else if (media instanceof tl_1.Api.MessageMediaDocument ||\r\n        media instanceof tl_1.Api.Document) {\r\n        return _downloadDocument(client, media, outputFile, date, thumb, progressCallback, msgData);\r\n    }\r\n    else if (media instanceof tl_1.Api.MessageMediaContact) {\r\n        return _downloadContact(client, media, {});\r\n    }\r\n    else if (media instanceof tl_1.Api.WebDocument ||\r\n        media instanceof tl_1.Api.WebDocumentNoProxy) {\r\n        return _downloadWebDocument(client, media, {});\r\n    }\r\n    else {\r\n        return buffer_1.Buffer.alloc(0);\r\n    }\r\n}\r\nexports.downloadMedia = downloadMedia;\r\n/** @hidden */\r\nasync function _downloadDocument(client, doc, outputFile, date, thumb, progressCallback, msgData) {\r\n    if (doc instanceof tl_1.Api.MessageMediaDocument) {\r\n        if (!doc.document) {\r\n            return buffer_1.Buffer.alloc(0);\r\n        }\r\n        doc = doc.document;\r\n    }\r\n    if (!(doc instanceof tl_1.Api.Document)) {\r\n        return buffer_1.Buffer.alloc(0);\r\n    }\r\n    let size;\r\n    if (thumb == undefined) {\r\n        outputFile = getProperFilename(outputFile, \"document\", \".\" + (__1.utils.getExtension(doc) || \"bin\"), date);\r\n    }\r\n    else {\r\n        outputFile = getProperFilename(outputFile, \"photo\", \".jpg\", date);\r\n        size = getThumb(doc.thumbs || [], thumb);\r\n        if (size instanceof tl_1.Api.PhotoCachedSize ||\r\n            size instanceof tl_1.Api.PhotoStrippedSize) {\r\n            return _downloadCachedPhotoSize(size, outputFile);\r\n        }\r\n    }\r\n    return await downloadFileV2(client, new tl_1.Api.InputDocumentFileLocation({\r\n        id: doc.id,\r\n        accessHash: doc.accessHash,\r\n        fileReference: doc.fileReference,\r\n        thumbSize: size ? size.type : \"\",\r\n    }), {\r\n        outputFile: outputFile,\r\n        fileSize: size && \"size\" in size ? (0, big_integer_1.default)(size.size) : doc.size,\r\n        progressCallback: progressCallback,\r\n        msgData: msgData,\r\n    });\r\n}\r\nexports._downloadDocument = _downloadDocument;\r\n/** @hidden */\r\nasync function _downloadContact(client, media, args) {\r\n    throw new Error(\"not implemented\");\r\n}\r\nexports._downloadContact = _downloadContact;\r\n/** @hidden */\r\nasync function _downloadWebDocument(client, media, args) {\r\n    throw new Error(\"not implemented\");\r\n}\r\nexports._downloadWebDocument = _downloadWebDocument;\r\nfunction pickFileSize(sizes, sizeType) {\r\n    if (!sizeType || !sizes || !sizes.length) {\r\n        return undefined;\r\n    }\r\n    const indexOfSize = sizeTypes.indexOf(sizeType);\r\n    let size;\r\n    for (let i = indexOfSize; i < sizeTypes.length; i++) {\r\n        size = sizes.find((s) => s.type === sizeTypes[i]);\r\n        if (size && !(size instanceof tl_1.Api.PhotoPathSize)) {\r\n            return size;\r\n        }\r\n    }\r\n    return undefined;\r\n}\r\n/** @hidden */\r\nfunction getThumb(thumbs, thumb) {\r\n    function sortThumb(thumb) {\r\n        if (thumb instanceof tl_1.Api.PhotoStrippedSize) {\r\n            return thumb.bytes.length;\r\n        }\r\n        if (thumb instanceof tl_1.Api.PhotoCachedSize) {\r\n            return thumb.bytes.length;\r\n        }\r\n        if (thumb instanceof tl_1.Api.PhotoSize) {\r\n            return thumb.size;\r\n        }\r\n        if (thumb instanceof tl_1.Api.PhotoSizeProgressive) {\r\n            return Math.max(...thumb.sizes);\r\n        }\r\n        if (thumb instanceof tl_1.Api.VideoSize) {\r\n            return thumb.size;\r\n        }\r\n        return 0;\r\n    }\r\n    thumbs = thumbs.sort((a, b) => sortThumb(a) - sortThumb(b));\r\n    const correctThumbs = [];\r\n    for (const t of thumbs) {\r\n        if (!(t instanceof tl_1.Api.PhotoPathSize)) {\r\n            correctThumbs.push(t);\r\n        }\r\n    }\r\n    if (thumb == undefined) {\r\n        return correctThumbs.pop();\r\n    }\r\n    else if (typeof thumb == \"number\") {\r\n        return correctThumbs[thumb];\r\n    }\r\n    else if (typeof thumb == \"string\") {\r\n        for (const t of correctThumbs) {\r\n            if (t.type == thumb) {\r\n                return t;\r\n            }\r\n        }\r\n    }\r\n    else if (thumb instanceof tl_1.Api.PhotoSize ||\r\n        thumb instanceof tl_1.Api.PhotoCachedSize ||\r\n        thumb instanceof tl_1.Api.PhotoStrippedSize ||\r\n        thumb instanceof tl_1.Api.VideoSize) {\r\n        return thumb;\r\n    }\r\n}\r\n/** @hidden */\r\nasync function _downloadCachedPhotoSize(size, outputFile) {\r\n    // No need to download anything, simply write the bytes\r\n    let data;\r\n    if (size instanceof tl_1.Api.PhotoStrippedSize) {\r\n        data = (0, Utils_1.strippedPhotoToJpg)(size.bytes);\r\n    }\r\n    else {\r\n        data = size.bytes;\r\n    }\r\n    const writer = getWriter(outputFile);\r\n    try {\r\n        await writer.write(data);\r\n    }\r\n    finally {\r\n        closeWriter(writer);\r\n    }\r\n    return returnWriterValue(writer);\r\n}\r\nexports._downloadCachedPhotoSize = _downloadCachedPhotoSize;\r\n/** @hidden */\r\nfunction getProperFilename(file, fileType, extension, date) {\r\n    if (!file || typeof file != \"string\") {\r\n        return file;\r\n    }\r\n    if (fs.existsSync(file) && fs.lstatSync(file).isDirectory()) {\r\n        let fullName = fileType + date + extension;\r\n        return path_1.default.join(file, fullName);\r\n    }\r\n    return file;\r\n}\r\n/** @hidden */\r\nasync function _downloadPhoto(client, photo, file, date, thumb, progressCallback) {\r\n    if (photo instanceof tl_1.Api.MessageMediaPhoto) {\r\n        if (photo.photo instanceof tl_1.Api.PhotoEmpty || !photo.photo) {\r\n            return buffer_1.Buffer.alloc(0);\r\n        }\r\n        photo = photo.photo;\r\n    }\r\n    if (!(photo instanceof tl_1.Api.Photo)) {\r\n        return buffer_1.Buffer.alloc(0);\r\n    }\r\n    const photoSizes = [...(photo.sizes || []), ...(photo.videoSizes || [])];\r\n    const size = getThumb(photoSizes, thumb);\r\n    if (!size || size instanceof tl_1.Api.PhotoSizeEmpty) {\r\n        return buffer_1.Buffer.alloc(0);\r\n    }\r\n    if (!date) {\r\n        date = Date.now();\r\n    }\r\n    file = getProperFilename(file, \"photo\", \".jpg\", date);\r\n    if (size instanceof tl_1.Api.PhotoCachedSize ||\r\n        size instanceof tl_1.Api.PhotoStrippedSize) {\r\n        return _downloadCachedPhotoSize(size, file);\r\n    }\r\n    let fileSize;\r\n    if (size instanceof tl_1.Api.PhotoSizeProgressive) {\r\n        fileSize = Math.max(...size.sizes);\r\n    }\r\n    else {\r\n        fileSize = size.size;\r\n    }\r\n    return downloadFileV2(client, new tl_1.Api.InputPhotoFileLocation({\r\n        id: photo.id,\r\n        accessHash: photo.accessHash,\r\n        fileReference: photo.fileReference,\r\n        thumbSize: size.type,\r\n    }), {\r\n        outputFile: file,\r\n        fileSize: (0, big_integer_1.default)(fileSize),\r\n        progressCallback: progressCallback,\r\n        dcId: photo.dcId,\r\n    });\r\n}\r\nexports._downloadPhoto = _downloadPhoto;\r\n/** @hidden */\r\nasync function downloadProfilePhoto(client, entity, fileParams) {\r\n    let photo;\r\n    if (typeof entity == \"object\" && \"photo\" in entity) {\r\n        photo = entity.photo;\r\n    }\r\n    else {\r\n        entity = await client.getEntity(entity);\r\n        if (\"photo\" in entity) {\r\n            photo = entity.photo;\r\n        }\r\n        else {\r\n            throw new Error(`Could not get photo from ${entity ? entity.className : undefined}`);\r\n        }\r\n    }\r\n    let dcId;\r\n    let loc;\r\n    if (photo instanceof tl_1.Api.UserProfilePhoto ||\r\n        photo instanceof tl_1.Api.ChatPhoto) {\r\n        dcId = photo.dcId;\r\n        loc = new tl_1.Api.InputPeerPhotoFileLocation({\r\n            peer: __1.utils.getInputPeer(entity),\r\n            photoId: photo.photoId,\r\n            big: fileParams.isBig,\r\n        });\r\n    }\r\n    else {\r\n        return buffer_1.Buffer.alloc(0);\r\n    }\r\n    return client.downloadFile(loc, {\r\n        outputFile: fileParams.outputFile,\r\n        dcId,\r\n    });\r\n}\r\nexports.downloadProfilePhoto = downloadProfilePhoto;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}